---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import Breadcrumbs from '../../components/Breadcrumbs.astro';
---

<BaseLayout 
  title="Kalkulator Kosztów Budowy Domu - Oblicz Budżet 2026 | Portal Budowlany"
  description="Darmowy kalkulator kosztów budowy domu. Oblicz dokładny budżet na budowę w systemie ekonomicznym lub deweloperskim."
>
  <Header />
  
  <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <Breadcrumbs 
      items={[
        { label: 'Strona główna', href: '/' },
        { label: 'Budowa', href: '/budowa' },
        { label: 'Kalkulator kosztów', href: '/budowa/kalkulator-kosztow' }
      ]}
    />

    <div class="mt-8">
      <h1 class="text-4xl font-bold text-zinc-700 mb-6">Kalkulator Kosztów Budowy Domu</h1>
      
      <p class="text-lg text-zinc-600 mb-8">
        Oblicz przybliżony koszt budowy swojego domu. Wybierz parametry i zobacz szacunkowy budżet.
      </p>

      <div class="bg-stone-200 rounded-lg p-8 mb-8">
        <form id="costCalculator" class="space-y-6">
          <div>
            <label for="area" class="block text-zinc-700 font-semibold mb-2">
              Powierzchnia użytkowa (m²)
            </label>
            <input 
              type="number" 
              id="area" 
              name="area" 
              min="50" 
              max="500" 
              value="120"
              class="w-full px-4 py-3 rounded-lg border-2 border-zinc-300 focus:border-orange-500 focus:outline-none"
            />
          </div>

          <div>
            <label class="block text-zinc-700 font-semibold mb-2">
              System budowy
            </label>
            <div class="space-y-2">
              <label class="flex items-center">
                <input type="radio" name="system" value="ekonomiczny" checked class="mr-3" />
                <span>System ekonomiczny (samodzielne zarządzanie)</span>
              </label>
              <label class="flex items-center">
                <input type="radio" name="system" value="deweloperski" class="mr-3" />
                <span>System deweloperski (generalny wykonawca)</span>
              </label>
            </div>
          </div>

          <div>
            <label class="block text-zinc-700 font-semibold mb-2">
              Dodatkowe elementy
            </label>
            <div class="space-y-2">
              <label class="flex items-center">
                <input type="checkbox" name="basement" class="mr-3" />
                <span>Piwnica użytkowa (+80,000 - 140,000 zł)</span>
              </label>
              <label class="flex items-center">
                <input type="checkbox" name="garage" class="mr-3" />
                <span>Garaż (+50,000 - 80,000 zł)</span>
              </label>
              <label class="flex items-center">
                <input type="checkbox" name="premium" class="mr-3" />
                <span>Wykończenie premium (+20% do kosztów)</span>
              </label>
            </div>
          </div>

          <button 
            type="submit"
            class="w-full bg-orange-500 text-white font-bold py-4 rounded-lg hover:bg-orange-600 transition-colors"
          >
            Oblicz koszt budowy
          </button>
        </form>
      </div>

      <div id="results" class="hidden bg-orange-50 border-l-4 border-orange-500 p-8 rounded-lg">
        <h2 class="text-2xl font-bold text-zinc-700 mb-4">Szacunkowy Koszt Budowy</h2>
        
        <div class="space-y-4 mb-6">
          <div class="flex justify-between items-center text-lg">
            <span class="text-zinc-600">Koszt podstawowy:</span>
            <span id="baseCost" class="font-bold text-zinc-700"></span>
          </div>
          <div class="flex justify-between items-center text-lg">
            <span class="text-zinc-600">Dodatkowe elementy:</span>
            <span id="extraCost" class="font-bold text-zinc-700"></span>
          </div>
          <div class="border-t-2 border-orange-500 pt-4 flex justify-between items-center text-xl">
            <span class="text-zinc-700 font-bold">Całkowity koszt:</span>
            <span id="totalCost" class="font-bold text-orange-600 text-2xl"></span>
          </div>
          <div class="flex justify-between items-center text-sm text-zinc-500">
            <span>Koszt za m²:</span>
            <span id="costPerM2"></span>
          </div>
        </div>

        <div class="bg-white p-4 rounded-lg">
          <p class="text-sm text-zinc-600">
            <strong>Uwaga:</strong> To szacunkowa kalkulacja. Rzeczywiste koszty mogą się różnić 
            w zależności od lokalizacji, wybranych materiałów i wykonawców. Zalecamy dodać 
            bufor 15-20% na nieprzewidziane wydatki.
          </p>
        </div>
      </div>
    </div>

    <div class="mt-12 prose prose-zinc max-w-none">
      <h2 class="text-2xl font-bold text-zinc-700 mb-4">Jak interpretować wyniki?</h2>
      
      <p class="text-zinc-600 mb-4">
        Kalkulator podaje szacunkowy koszt budowy na podstawie średnich cen materiałów 
        i robocizny w 2026 roku.
      </p>

      <h3 class="text-xl font-bold text-zinc-700 mt-6 mb-3">Zakres kosztów podstawowych obejmuje:</h3>
      <ul class="list-disc pl-6 text-zinc-600 space-y-2 mb-6">
        <li>Projekt i dokumentacja</li>
        <li>Przygotowanie działki i przyłącza</li>
        <li>Stan zerowy (fundamenty)</li>
        <li>Stan surowy zamknięty (ściany, dach, okna)</li>
        <li>Instalacje (elektryka, woda, CO)</li>
        <li>Wykończenie podstawowe</li>
      </ul>

      <h3 class="text-xl font-bold text-zinc-700 mt-6 mb-3">Co NIE jest wliczone w koszt:</h3>
      <ul class="list-disc pl-6 text-zinc-600 space-y-2 mb-6">
        <li>Zakup działki</li>
        <li>Zagospodarowanie terenu (ogrodzenie, podjazd, chodniki)</li>
        <li>Meble i AGD</li>
        <li>Projekty adaptacyjne (jeśli kupujesz gotowy projekt)</li>
      </ul>
    </div>
  </main>

  <Footer />

  <script>
    document.getElementById('costCalculator')?.addEventListener('submit', function(e) {
      e.preventDefault();
      
      const area = parseInt((document.getElementById('area') as HTMLInputElement).value);
      const system = (document.querySelector('input[name="system"]:checked') as HTMLInputElement).value;
      const basement = (document.querySelector('input[name="basement"]') as HTMLInputElement).checked;
      const garage = (document.querySelector('input[name="garage"]') as HTMLInputElement).checked;
      const premium = (document.querySelector('input[name="premium"]') as HTMLInputElement).checked;
      
      let costPerM2Min = system === 'ekonomiczny' ? 4000 : 5000;
      let costPerM2Max = system === 'ekonomiczny' ? 5000 : 6000;
      
      if (premium) {
        costPerM2Min *= 1.2;
        costPerM2Max *= 1.2;
      }
      
      let baseCostMin = area * costPerM2Min;
      let baseCostMax = area * costPerM2Max;
      
      let extraCostMin = 0;
      let extraCostMax = 0;
      
      if (basement) {
        extraCostMin += 80000;
        extraCostMax += 140000;
      }
      
      if (garage) {
        extraCostMin += 50000;
        extraCostMax += 80000;
      }
      
      const totalMin = baseCostMin + extraCostMin;
      const totalMax = baseCostMax + extraCostMax;
      
      const avgCostPerM2 = Math.round((totalMin + totalMax) / 2 / area);
      
      document.getElementById('baseCost')!.textContent = 
        `${baseCostMin.toLocaleString('pl-PL')} - ${baseCostMax.toLocaleString('pl-PL')} zł`;
      
      document.getElementById('extraCost')!.textContent = 
        extraCostMin > 0 
          ? `${extraCostMin.toLocaleString('pl-PL')} - ${extraCostMax.toLocaleString('pl-PL')} zł`
          : '0 zł';
      
      document.getElementById('totalCost')!.textContent = 
        `${totalMin.toLocaleString('pl-PL')} - ${totalMax.toLocaleString('pl-PL')} zł`;
      
      document.getElementById('costPerM2')!.textContent = 
        `${avgCostPerM2.toLocaleString('pl-PL')} zł/m²`;
      
      document.getElementById('results')!.classList.remove('hidden');
      document.getElementById('results')!.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    });
  </script>
</BaseLayout>
