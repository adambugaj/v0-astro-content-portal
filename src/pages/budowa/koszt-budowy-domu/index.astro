---
import BaseLayout from '../../../layouts/BaseLayout.astro';
import Header from '../../../components/Header.astro';
import Footer from '../../../components/Footer.astro';
import ArticleSidebar from '../../../components/ArticleSidebar.astro';
import Breadcrumbs from '../../../components/Breadcrumbs.astro';
import BuildCalculator from '../../../components/BuildCalculator.astro';

const breadcrumbs = [
  { label: 'Strona główna', href: '/' },
  { label: 'Budowa', href: '/budowa' },
  { label: 'Koszt Budowy Domu' }
];
---

<BaseLayout 
  title="Koszt Budowy Domu 2026 - Kompletny Przewodnik Inwestora | domjakosci.pl"
  description="Sprawdź aktualny koszt budowy domu w 2026 roku. Skorzystaj z kalkulatora budowlanego, checklisty i dowiedz się, jak zaplanować budżet."
  type="article"
  author="Dariusz Nowicki"
>
  <Header />
  
  <!-- Added progress bar under header -->
  <div class="sticky top-16 z-40 h-1 bg-stone-200">
    <div id="progressBar" class="h-full bg-orange-500 transition-all duration-300" style="width: 0%"></div>
  </div>

  <!-- Structured Data: Article, FAQ, HowTo (calculator action) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "Article",
        "mainEntityOfPage": { "@type": "WebPage", "@id": "https://domjakosci.pl/budowa/koszt-budowy-domu" },
        "headline": "Koszt Budowy Domu 2026: Kompletny Przewodnik Inwestora",
        "image": "https://domjakosci.pl/images/koszt-budowy-domu.webp",
        "description": "Sprawdź aktualny koszt budowy domu w 2026 roku. Skorzystaj z kalkulatora budowlanego, checklisty i dowiedz się, jak zaplanować budżet.",
        "author": { "@type": "Person", "name": "Dariusz Nowicki" },
        "datePublished": "2026-01-12",
        "dateModified": "2026-01-12"
      },
      {
        "@type": "FAQPage",
        "mainEntity": [
          {
            "@type": "Question",
            "name": "Ile kosztuje budowa domu w 2026 roku?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Koszt budowy domu w 2026 roku wynosi średnio od 4200 do 8500 zł za m², w zależności od standardu wykończenia. Dom 120 m² w standardzie kosztuje około 696 000 zł bez garażu."
            }
          },
          {
            "@type": "Question",
            "name": "Jakie są główne komponenty kosztu budowy?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Koszt budowy dzieli się na trzy główne części: Roboty konstrukcyjne (ok. 35%), Roboty developerskie (ok. 45%) i Wykończenie (ok. 20%)."
            }
          },
          {
            "@type": "Question",
            "name": "Czy można budować bez pozwolenia?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Prawo budowlane zwykle wymaga pozwolenia. Budowa bez pozwolenia grozi sankcjami. Sprawdź lokalne przepisy dla wyjątków."
            }
          }
        ]
      },
      {
        "@type": "HowTo",
        "name": "Oblicz koszt budowy za pomocą kalkulatora",
        "description": "Krótkie kroki do użycia kalkulatora kosztów budowy: wybierz region, technologię, powierzchnię i opcje dodatkowe.",
        "step": [
          { "@type": "HowToStep", "name": "Wprowadź powierzchnię domu (m²)" },
          { "@type": "HowToStep", "name": "Wybierz region (Warszawa, Kraków, Poznań, mniejsze miasta)" },
          { "@type": "HowToStep", "name": "Wybierz technologię (murowany, szkieletowy, modułowy)" },
          { "@type": "HowToStep", "name": "Wybierz opcje dodatkowe (garaż, piwnica, OZE)" },
          { "@type": "HowToStep", "name": "Odczytaj widełki kosztów i rozkład etapów" }
        ],
        "potentialAction": {
          "@type": "Action",
          "name": "Oblicz koszty w kalkulatorze",
          "target": {
            "@type": "EntryPoint",
            "urlTemplate": "https://domjakosci.pl/budowa/koszt-budowy-domu#kalkulator"
          }
        }
      }
    ]
  }
  </script>

  <!-- Left TOC removed for cleaner, wider layout on category pages -->
  
  <main class="lg:ml-48 max-w-7xl mx-auto px-4 py-12">
    <Breadcrumbs items={breadcrumbs} />
    
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <article class="lg:col-span-2">
        <header class="mb-12">
          <span class="inline-block py-1 px-3 rounded-full bg-orange-100 text-orange-600 text-sm font-semibold mb-4">
            Aktualizacja: Styczeń 2026
          </span>
          <h1 class="text-4xl lg:text-5xl font-extrabold tracking-tight text-zinc-700 mb-6">
            Koszt Budowy Domu 2026: Kompletny Przewodnik Inwestora
          </h1>
          <p class="text-xl text-zinc-600 leading-relaxed mb-8">
            Planujesz budowę domu w 2026 roku? Ceny materiałów i robocizny dynamicznie się zmieniają. 
            Nasz przewodnik pomoże Ci precyzyjnie oszacować budżet, uniknąć ukrytych kosztów i przygotować się 
            do procesu inwestycyjnego krok po kroku.
          </p>
          <figure class="mb-8">
            <img src="/images/koszt-budowy-domu.webp" alt="Dom w trakcie budowy z planami na pierwszym planie" class="w-full rounded-2xl shadow-md object-cover max-h-96" />
          </figure>
        </header>

        <!-- Kalkulator jako Astro Island (client:load) -->
        <BuildCalculator client:load />

        <!-- Checklist Section (guided stepper + printable checklist) -->
        <section id="checklist" class="py-12 mb-12">
          <h2 class="text-3xl font-bold text-zinc-700 mb-4">Krok po kroku — przewodnik budowy domu</h2>

          <div class="flex items-center gap-4 mb-4">
            <button id="guidedToggle" class="px-4 py-2 rounded-lg bg-orange-500 text-white">Tryb przewodnika</button>
            <button id="printChecklist" class="px-4 py-2 rounded-lg border border-stone-300">Pobierz jako PDF</button>
            <div class="ml-auto flex items-center gap-3">
              <div class="w-12 h-12 bg-orange-500 rounded-full flex items-center justify-center">
                <span class="text-lg font-bold text-white" id="checklist-progress-text">0%</span>
              </div>
              <div class="w-40 bg-stone-300 rounded-full h-2">
                <div id="checklist-progress-bar" class="bg-orange-500 h-full rounded-full transition-all duration-300" style="width: 0%"></div>
              </div>
            </div>
          </div>

          <div id="checklist-instruction-msg" class="bg-blue-50 border border-blue-200 text-blue-700 p-4 rounded-lg mb-6">
            Użyj trybu przewodnika, aby przejść krok po kroku lub zaznaczaj elementy ręcznie.
          </div>

          <div id="checklist-success-msg" class="bg-green-50 border border-green-200 text-green-700 p-4 rounded-lg mb-6 hidden">
            Świetnie! Ukończyłeś wszystkie kroki. Możesz pobrać checklistę jako PDF.
          </div>

          <div class="space-y-3" id="checklist-list">
            <div class="checklist-item-container">
              <label class="flex items-start gap-3 cursor-pointer p-4 rounded-lg border border-stone-200 hover:bg-stone-50 transition-colors">
                <input type="checkbox" data-step="1" class="checklist-checkbox w-5 h-5 rounded border-stone-300 text-orange-500 mt-1" />
                <span class="flex-1">
                  <span class="block font-semibold text-zinc-700 checklist-label">1. Zakup działki i sprawdzenie własności</span>
                  <span class="checklist-tip text-xs text-zinc-500 mt-1 block">Sprawdź plan miejscowy i dostęp do mediów.</span>
                </span>
              </label>
            </div>

            <div class="checklist-item-container">
              <label class="flex items-start gap-3 cursor-pointer p-4 rounded-lg border border-stone-200 hover:bg-stone-50 transition-colors">
                <input type="checkbox" data-step="2" class="checklist-checkbox w-5 h-5 rounded border-stone-300 text-orange-500 mt-1" />
                <span class="flex-1">
                  <span class="block font-semibold text-zinc-700 checklist-label">2. Projekt architektoniczno-budowlany</span>
                  <span class="checklist-tip text-xs text-zinc-500 mt-1 block">Zamów projekt, sprawdź koszty adaptacji.</span>
                </span>
              </label>
            </div>

            <div class="checklist-item-container">
              <label class="flex items-start gap-3 cursor-pointer p-4 rounded-lg border border-stone-200 hover:bg-stone-50 transition-colors">
                <input type="checkbox" data-step="3" class="checklist-checkbox w-5 h-5 rounded border-stone-300 text-orange-500 mt-1" />
                <span class="flex-1">
                  <span class="block font-semibold text-zinc-700 checklist-label">3. Pozwolenia i formalności</span>
                  <span class="checklist-tip text-xs text-zinc-500 mt-1 block">Wniosek o pozwolenie, uzgodnienia z sieciami.</span>
                </span>
              </label>
            </div>

            <div class="checklist-item-container">
              <label class="flex items-start gap-3 cursor-pointer p-4 rounded-lg border border-stone-200 hover:bg-stone-50 transition-colors">
                <input type="checkbox" data-step="4" class="checklist-checkbox w-5 h-5 rounded border-stone-300 text-orange-500 mt-1" />
                <span class="flex-1">
                  <span class="block font-semibold text-zinc-700 checklist-label">4. Fundamenty</span>
                  <span class="checklist-tip text-xs text-zinc-500 mt-1 block">Wykopy, zbrojenie, podstawowe izolacje.</span>
                </span>
              </label>
            </div>

            <div class="checklist-item-container">
              <label class="flex items-start gap-3 cursor-pointer p-4 rounded-lg border border-stone-200 hover:bg-stone-50 transition-colors">
                <input type="checkbox" data-step="5" class="checklist-checkbox w-5 h-5 rounded border-stone-300 text-orange-500 mt-1" />
                <span class="flex-1">
                  <span class="block font-semibold text-zinc-700 checklist-label">5. Ściany i konstrukcja</span>
                  <span class="checklist-tip text-xs text-zinc-500 mt-1 block">Wybierz technologię i sprawdź koszty materiałów.</span>
                </span>
              </label>
            </div>

            <div class="checklist-item-container">
              <label class="flex items-start gap-3 cursor-pointer p-4 rounded-lg border border-stone-200 hover:bg-stone-50 transition-colors">
                <input type="checkbox" data-step="6" class="checklist-checkbox w-5 h-5 rounded border-stone-300 text-orange-500 mt-1" />
                <span class="flex-1">
                  <span class="block font-semibold text-zinc-700 checklist-label">6. Dach</span>
                  <span class="checklist-tip text-xs text-zinc-500 mt-1 block">Wybór pokrycia i wykonawcy, izolacje przeciwwilgociowe.</span>
                </span>
              </label>
            </div>

            <div class="checklist-item-container">
              <label class="flex items-start gap-3 cursor-pointer p-4 rounded-lg border border-stone-200 hover:bg-stone-50 transition-colors">
                <input type="checkbox" data-step="7" class="checklist-checkbox w-5 h-5 rounded border-stone-300 text-orange-500 mt-1" />
                <span class="flex-1">
                  <span class="block font-semibold text-zinc-700 checklist-label">7. Instalacje (elektryka, wod.-kan., OZE)</span>
                  <span class="checklist-tip text-xs text-zinc-500 mt-1 block">Zaplanować trasy, koszty i ewentualne dotacje OZE.</span>
                </span>
              </label>
            </div>

            <div class="checklist-item-container">
              <label class="flex items-start gap-3 cursor-pointer p-4 rounded-lg border border-stone-200 hover:bg-stone-50 transition-colors">
                <input type="checkbox" data-step="8" class="checklist-checkbox w-5 h-5 rounded border-stone-300 text-orange-500 mt-1" />
                <span class="flex-1">
                  <span class="block font-semibold text-zinc-700 checklist-label">8. Wykończenie</span>
                  <span class="checklist-tip text-xs text-zinc-500 mt-1 block">Podłogi, stolarka, malowanie — negocjuj pakiety z wykonawcami.</span>
                </span>
              </label>
            </div>
          </div>

          <div id="guided-controls" class="mt-4 hidden items-center gap-3">
            <button id="prevStep" class="px-4 py-2 rounded-lg border">Poprzedni</button>
            <button id="nextStep" class="px-4 py-2 rounded-lg bg-orange-500 text-white">Następny</button>
            <div class="text-sm text-zinc-600 ml-4">Krok <span id="guidedCurrent">1</span> / <span id="guidedTotal">8</span></div>
          </div>
        </section>

        <!-- FAQ Section -->
        <section id="faq" class="py-12 mb-12">
          <h2 class="text-3xl font-bold text-zinc-700 mb-8">Pytania i Odpowiedzi</h2>
          
          <div class="space-y-4">
            <div class="border border-stone-200 rounded-lg overflow-hidden">
              <button type="button" class="faq-toggle w-full text-left p-6 bg-stone-50 hover:bg-stone-100 transition-colors flex items-center justify-between" aria-expanded="false">
                <span class="font-semibold text-zinc-700">Ile kosztuje budowa domu w 2026 roku?</span>
                <svg class="icon-transform w-5 h-5 text-zinc-600 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
                </svg>
              </button>
              <div class="max-h-0 overflow-hidden opacity-0 transition-all duration-300">
                <div class="p-6 bg-white border-t border-stone-200">
                  <p class="text-zinc-600">Koszt budowy domu w 2026 roku wynosi średnio od 4200 do 8500 zł za m², w zależności od standardu wykończenia. Dom 120 m² w standardzie kosztuje około 696 000 zł bez garaży, lub 741 000 zł z garażem.</p>
                </div>
              </div>
            </div>

            <div class="border border-stone-200 rounded-lg overflow-hidden">
              <button type="button" class="faq-toggle w-full text-left p-6 bg-stone-50 hover:bg-stone-100 transition-colors flex items-center justify-between" aria-expanded="false">
                <span class="font-semibold text-zinc-700">Jakie są główne komponenty kosztu budowy?</span>
                <svg class="icon-transform w-5 h-5 text-zinc-600 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
                </svg>
              </button>
              <div class="max-h-0 overflow-hidden opacity-0 transition-all duration-300">
                <div class="p-6 bg-white border-t border-stone-200">
                  <p class="text-zinc-600 mb-3">Koszt budowy dzieli się na trzy główne części:</p>
                  <ul class="text-zinc-600 space-y-2">
                    <li><strong>Roboty raw (35%)</strong> - wykopy, fundamenty, ściany</li>
                    <li><strong>Roboty developerskie (45%)</strong> - stropy, dach, instalacje</li>
                    <li><strong>Wykończenie (20%)</strong> - malarstwo, podłogi, drzwi</li>
                  </ul>
                </div>
              </div>
            </div>

            <div class="border border-stone-200 rounded-lg overflow-hidden">
              <button type="button" class="faq-toggle w-full text-left p-6 bg-stone-50 hover:bg-stone-100 transition-colors flex items-center justify-between" aria-expanded="false">
                <span class="font-semibold text-zinc-700">Czy może budować bez pozwolenia?</span>
                <svg class="icon-transform w-5 h-5 text-zinc-600 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
                </svg>
              </button>
              <div class="max-h-0 overflow-hidden opacity-0 transition-all duration-300">
                <div class="p-6 bg-white border-t border-stone-200">
                  <p class="text-zinc-600">Prawo budowlane wymaga pozwolenia na budowę dla domów jednorodzinnych. Budowa bez pozwolenia grozi karami finansowymi i nakazem rozbiórki. Istnieją wyjątki dla małych garaży i obiektów gospodarczych - sprawdź przepisy dla Twojej gminy.</p>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Related Articles -->
        <section class="mt-16 pt-12 border-t border-stone-300">
          <h2 class="text-2xl font-bold text-zinc-700 mb-6">Poznaj więcej na temat budowy domu</h2>
          <div class="grid md:grid-cols-2 gap-4">
            <a href="/budowa/etapy-budowy/" class="p-4 border border-stone-300 rounded-lg hover:border-orange-500 hover:shadow-md transition-all">
              <h3 class="font-semibold text-zinc-700 mb-2">Etapy budowy</h3>
              <p class="text-sm text-zinc-600">Przewodnik po kolejnych etapach od fundamentów do dachu</p>
            </a>
            <a href="/budowa/koszt-budowy-domu/koszt-system-gospodarczy" class="p-4 border border-stone-300 rounded-lg hover:border-orange-500 hover:shadow-md transition-all">
              <h3 class="font-semibold text-zinc-700 mb-2">Budowa systemem gospodarczym</h3>
              <p class="text-sm text-zinc-600">Oszczędzaj na kosztach — praktyczne porady</p>
            </a>
            <a href="/budowa/koszt-budowy-domu/koszt-100m2" class="p-4 border border-stone-300 rounded-lg hover:border-orange-500 hover:shadow-md transition-all">
              <h3 class="font-semibold text-zinc-700 mb-2">Koszt budowy domu 100 m²</h3>
              <p class="text-sm text-zinc-600">Szczegółowy przydział kosztów dla domu 100 m²</p>
            </a>
            <a href="/budowa/koszt-budowy-domu/koszt-fundamentow" class="p-4 border border-stone-300 rounded-lg hover:border-orange-500 hover:shadow-md transition-all">
              <h3 class="font-semibold text-zinc-700 mb-2">Koszt fundamentów</h3>
              <p class="text-sm text-zinc-600">Wycena i rodzaje fundamentów</p>
            </a>
          </div>
        </section>
      </article>

      <!-- Sidebar now shows minimal and at bottom -->
      <aside class="lg:col-span-1">
        <ArticleSidebar />
      </aside>
    </div>
  </main>

  <Footer />

  <script>
    // TOC generation and scroll tracking
    document.addEventListener('DOMContentLoaded', () => {
      const headings = document.querySelectorAll('article h2, article h3');
      const tocNav = document.getElementById('tocNav');

      headings.forEach((heading, index) => {
        if (!heading.id) heading.id = `heading-${index}`;
        const link = document.createElement('a');
        link.href = `#${heading.id}`;
        link.className = `text-sm block py-1 px-2 rounded transition-colors ${
          heading.tagName === 'H3' ? 'ml-3 text-zinc-600 hover:text-orange-500' : 'font-medium text-zinc-700 hover:text-orange-500'
        }`;
        link.textContent = heading.textContent;
        tocNav?.appendChild(link);
      });

      // Progress bar on scroll
      window.addEventListener('scroll', () => {
        const docHeight = document.documentElement.scrollHeight - window.innerHeight;
        const scrollPercent = (window.scrollY / docHeight) * 100;
        const progressBar = document.getElementById('progressBar');
        if (progressBar) progressBar.style.width = scrollPercent + '%';
      });


      const checkboxes = document.querySelectorAll('.checklist-checkbox');
      const progressText = document.getElementById('checklist-progress-text');
      const progressBar = document.getElementById('checklist-progress-bar');
      const successMsg = document.getElementById('checklist-success-msg');
      const instructMsg = document.getElementById('checklist-instruction-msg');
      const guidedToggle = document.getElementById('guidedToggle');
      const guidedControls = document.getElementById('guided-controls');
      const prevStep = document.getElementById('prevStep');
      const nextStep = document.getElementById('nextStep');
      const guidedCurrent = document.getElementById('guidedCurrent');
      const guidedTotal = document.getElementById('guidedTotal');
      const printChecklist = document.getElementById('printChecklist');

      let guidedMode = false;
      let currentStep = 1;
      const totalSteps = checkboxes.length;
      if(guidedTotal) guidedTotal.innerText = totalSteps;

      function updateChecklist() {
        const total = checkboxes.length;
        let checked = 0;
        
        checkboxes.forEach(cb => {
          const label = cb.closest('.checklist-item-container').querySelector('.checklist-label');
          const tip = cb.closest('.checklist-item-container').querySelector('.checklist-tip');
          
          if(cb.checked) {
            checked++;
            label.classList.add('text-stone-400', 'line-through');
            label.classList.remove('text-zinc-700');
            if(tip) tip.style.display = 'none';
          } else {
            label.classList.remove('text-stone-400', 'line-through');
            label.classList.add('text-zinc-700');
            if(tip) tip.style.display = 'block';
          }
        });

        const percent = Math.round((checked / total) * 100);
        if(progressText) progressText.innerText = percent + '%';
        if(progressBar) progressBar.style.width = percent + '%';

        if(checked === total) {
          if(successMsg) successMsg.classList.remove('hidden');
          if(successMsg) successMsg.classList.add('block');
          if(instructMsg) instructMsg.classList.add('hidden');
        } else {
          if(successMsg) successMsg.classList.add('hidden');
          if(successMsg) successMsg.classList.remove('block');
          if(instructMsg) instructMsg.classList.remove('hidden');
        }
      }

      // Guided mode: show one step at a time
      function showGuidedStep(step) {
        currentStep = Math.max(1, Math.min(step, totalSteps));
        checkboxes.forEach(cb => {
          const stepIndex = Number(cb.getAttribute('data-step')) || 0;
          const container = cb.closest('.checklist-item-container');
          if(stepIndex === currentStep) {
            container.style.display = 'block';
            container.scrollIntoView({behavior: 'smooth', block: 'center'});
          } else {
            container.style.display = 'none';
          }
        });
        if(guidedCurrent) guidedCurrent.innerText = currentStep;
      }

      function enterGuided() {
        guidedMode = true;
        guidedControls.classList.remove('hidden');
        guidedToggle.innerText = 'Wyjdź z trybu przewodnika';
        showGuidedStep(1);
      }

      function exitGuided() {
        guidedMode = false;
        guidedControls.classList.add('hidden');
        guidedToggle.innerText = 'Tryb przewodnika';
        // show all items
        checkboxes.forEach(cb => cb.closest('.checklist-item-container').style.display = 'block');
      }

      guidedToggle?.addEventListener('click', () => {
        if(!guidedMode) enterGuided(); else exitGuided();
      });

      prevStep?.addEventListener('click', () => {
        showGuidedStep(currentStep - 1);
      });
      nextStep?.addEventListener('click', () => {
        // if current step checkbox exists, mark it as done when Next
        const cb = document.querySelector(`.checklist-checkbox[data-step="${currentStep}"]`);
        if(cb && !cb.checked) { cb.checked = true; cb.dispatchEvent(new Event('change')); }
        showGuidedStep(currentStep + 1);
      });

      // Print / Download as PDF (use jsPDF to generate downloadable checklist)
      async function generateChecklistPDF() {
        // load jsPDF if needed
        if (!window.jspdf) {
          await new Promise((resolve, reject) => {
            const s = document.createElement('script');
            s.src = 'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js';
            s.onload = resolve; s.onerror = reject; document.head.appendChild(s);
          });
        }
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF({ unit: 'pt', format: 'a4' });
        const title = document.querySelector('article h1')?.innerText || 'Checklist';
        doc.setFontSize(16);
        doc.text(title, 40, 50);
        doc.setFontSize(11);
        let y = 80;
        checkboxes.forEach(cb => {
          const label = cb.closest('.checklist-item-container').querySelector('.checklist-label').innerText.trim();
          const status = cb.checked ? '✓' : '○';
          const line = `${status} ${label}`;
          const split = doc.splitTextToSize(line, 500);
          doc.text(split, 40, y);
          y += split.length * 14;
          if (y > 740) { doc.addPage(); y = 40; }
        });
        doc.save('checklist-budowa.pdf');
      }

      printChecklist?.addEventListener('click', (e) => {
        e.preventDefault();
        generateChecklistPDF().catch(() => { window.print(); });
      });

      checkboxes.forEach(cb => {
        cb.addEventListener('change', updateChecklist);
      });

      const faqToggles = document.querySelectorAll('.faq-toggle');
      
      faqToggles.forEach(toggle => {
        toggle.addEventListener('click', function() {
          const expanded = this.getAttribute('aria-expanded') === 'true';
          const content = this.nextElementSibling;
          const icon = this.querySelector('.icon-transform');

          this.setAttribute('aria-expanded', !expanded);
          if(!expanded) {
             content.classList.remove('max-h-0', 'opacity-0');
             content.classList.add('max-h-48', 'opacity-100');
             icon.classList.add('rotate-180');
          } else {
             content.classList.add('max-h-0', 'opacity-0');
             content.classList.remove('max-h-48', 'opacity-100');
             icon.classList.remove('rotate-180');
          }
        });
      });

      updateCalc();
      updateChecklist();
    });
  </script>
</BaseLayout>


