---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import ArticleSidebar from '../../components/ArticleSidebar.astro';
import Breadcrumbs from '../../components/Breadcrumbs.astro';

const breadcrumbs = [
  { label: 'Strona główna', href: '/' },
  { label: 'Budowa', href: '/budowa' },
  { label: 'Koszt Budowy Domu' }
];
---

<BaseLayout 
  title="Koszt Budowy Domu - Kompletny Przewodnik | domjakosci.pl"
  description="Sprawdź aktualny koszt budowy domu. Skorzystaj z kalkulatora budowlanego, checklisty i dowiedz się, jak zaplanować budżet."
  type="article"
  author="Dariusz Nowicki"
>
  <Header />
  
  <!-- Added progress bar under header -->
  <div class="sticky top-16 z-40 h-1 bg-stone-200">
    <div id="progressBar" class="h-full bg-orange-500 transition-all duration-300" style="width: 0%"></div>
  </div>

  <!-- Added sticky left sidebar with TOC -->
  <div class="fixed left-0 top-20 hidden lg:block w-48 h-[calc(100vh-80px)] overflow-y-auto border-r border-stone-300 bg-stone-50 p-6">
    <nav id="tocNav" class="space-y-2">
      <p class="text-xs font-bold text-zinc-600 mb-4 uppercase">Spis treści</p>
    </nav>
  </div>
  
  <main class="lg:ml-48 max-w-7xl mx-auto px-4 py-12">
    <Breadcrumbs items={breadcrumbs} />
    
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <article class="lg:col-span-2">
        <header class="mb-12">
          <span class="inline-block py-1 px-3 rounded-full bg-orange-100 text-orange-600 text-sm font-semibold mb-4">
            Aktualizacja: Styczeń 2026
          </span>
          <h1 class="text-4xl lg:text-5xl font-extrabold tracking-tight text-zinc-700 mb-6">
            Koszt Budowy Domu: Kompletny Przewodnik Inwestora
          </h1>
          <p class="text-xl text-zinc-600 leading-relaxed">
            Planujesz budowę domu? Ceny materiałów i robocizny dynamicznie się zmieniają. 
            Nasz przewodnik pomoże Ci precyzyjnie oszacować budżet, uniknąć ukrytych kosztów i przygotować się 
            do procesu inwestycyjnego krok po kroku.
          </p>
        </header>


        <!-- Added related topics section at bottom -->
        <section class="mt-16 pt-12 border-t border-stone-300">
          <h2 class="text-2xl font-bold text-zinc-700 mb-6">Poznaj więcej na temat budowy domu</h2>
          <div class="grid md:grid-cols-2 gap-4">
            <a href="/budowa/bledy-przy-budowie" class="p-4 border border-stone-300 rounded-lg hover:border-orange-500 hover:shadow-md transition-all">
              <h3 class="font-semibold text-zinc-700 mb-2">10 Najczęstszych Błędów przy Budowie</h3>
              <p class="text-sm text-zinc-600">Poznaj najczęstsze błędy i jak ich uniknąć</p>
            </a>
            <a href="/budowa/system-gospodarczy" class="p-4 border border-stone-300 rounded-lg hover:border-orange-500 hover:shadow-md transition-all">
              <h3 class="font-semibold text-zinc-700 mb-2">Budowa Systemem Gospodarczym</h3>
              <p class="text-sm text-zinc-600">Oszczędzaj na kosztach - buduj systemem gospodarczym</p>
            </a>
            <a href="/budowa/koszt-120m2" class="p-4 border border-stone-300 rounded-lg hover:border-orange-500 hover:shadow-md transition-all">
              <h3 class="font-semibold text-zinc-700 mb-2">Koszt Budowy Domu 120 m²</h3>
              <p class="text-sm text-zinc-600">Szczegółowy przydział kosztów dla domu 120 m²</p>
            </a>
            <a href="/budowa/koszt-140m2-piwnica" class="p-4 border border-stone-300 rounded-lg hover:border-orange-500 hover:shadow-md transition-all">
              <h3 class="font-semibold text-zinc-700 mb-2">Koszt Budowy z Piwnicą - 140 m²</h3>
              <p class="text-sm text-zinc-600">Wycena dla większego domu z piwnicą</p>
            </a>
          </div>
        </section>
      </article>

      <!-- Sidebar now shows minimal and at bottom -->
      <aside class="lg:col-span-1">
        <ArticleSidebar />
      </aside>
    </div>
  </main>

  <Footer />

  <script>
    // TOC generation and scroll tracking
    document.addEventListener('DOMContentLoaded', () => {
      const headings = document.querySelectorAll('article h2, article h3');
      const tocNav = document.getElementById('tocNav');
      
      headings.forEach((heading, index) => {
        if (!heading.id) heading.id = `heading-${index}`;
        const link = document.createElement('a');
        link.href = `#${heading.id}`;
        link.className = `text-sm block py-1 px-2 rounded transition-colors ${
          heading.tagName === 'H3' ? 'ml-3 text-zinc-600 hover:text-orange-500' : 'font-medium text-zinc-700 hover:text-orange-500'
        }`;
        link.textContent = heading.textContent;
        tocNav?.appendChild(link);
      });

      // Progress bar on scroll
      window.addEventListener('scroll', () => {
        const docHeight = document.documentElement.scrollHeight - window.innerHeight;
        const scrollPercent = (window.scrollY / docHeight) * 100;
        const progressBar = document.getElementById('progressBar');
        if (progressBar) progressBar.style.width = scrollPercent + '%';
      });
    });
  </script>
</BaseLayout>
