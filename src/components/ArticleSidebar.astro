---
const { editors = [] } = Astro.props;

const defaultEditors = [
  {
    name: 'Dariusz Nowicki',
    title: 'Redaktor Naczelny',
    image: '/images/dariusz-nowicki.jpg'
  },
  {
    name: 'Monika Zielińska',
    title: 'Zastępca Redaktora',
    image: '/images/monika-zielinska.jpg'
  }
];

const displayEditors = editors.length > 0 ? editors : defaultEditors;
---

<aside class="space-y-6">
  <!-- Editors Section -->
  <div class="bg-white border border-stone-300 rounded-xl p-6 sticky top-20">
    <h3 class="text-lg font-bold text-zinc-700 mb-4 border-b border-stone-300 pb-3">Redakcja</h3>
    <div class="space-y-4">
      {displayEditors.map((editor) => (
        <div class="flex items-center gap-3">
          <img 
            src={editor.image || "/placeholder.svg"}
            alt={editor.name}
            class="w-12 h-12 rounded-full object-cover border-2 border-orange-500"
          />
          <div>
            <p class="text-sm font-bold text-zinc-700">{editor.name}</p>
            <p class="text-xs text-zinc-500">{editor.title}</p>
          </div>
        </div>
      ))}
    </div>
    <a href="/o-redakcji" class="block text-center text-sm text-orange-500 hover:text-orange-600 font-semibold mt-4 pt-3 border-t border-stone-300">
      Poznaj całą redakcję →
    </a>
  </div>

  <!-- Table of Contents -->
  <div class="bg-white border border-stone-300 rounded-xl p-6 sticky top-96">
    <h3 class="text-lg font-bold text-zinc-700 mb-4">Spis treści</h3>
    <nav id="toc-nav" class="space-y-2 text-sm">
      <!-- JavaScript will populate this -->
    </nav>
  </div>

  <!-- Related Articles -->
  <div class="bg-stone-50 border border-stone-300 rounded-xl p-6">
    <h3 class="text-lg font-bold text-zinc-700 mb-4">Powiązane artykuły</h3>
    <div class="space-y-3">
      <a href="/budowa/bledy-przy-budowie" class="block text-sm text-zinc-700 hover:text-orange-500 font-medium transition-colors">
        → Najczęstsze błędy przy budowie
      </a>
      <a href="/budowa/system-gospodarczy" class="block text-sm text-zinc-700 hover:text-orange-500 font-medium transition-colors">
        → System gospodarczy budowy
      </a>
      <a href="/budowa/kalkulator-kosztow" class="block text-sm text-zinc-700 hover:text-orange-500 font-medium transition-colors">
        → Kalkulatory kosztów
      </a>
    </div>
  </div>
</aside>

<script>
  // Generate Table of Contents from article headings
  document.addEventListener('DOMContentLoaded', () => {
    const article = document.querySelector('article');
    const tocNav = document.getElementById('toc-nav');
    
    if (article && tocNav) {
      const headings = article.querySelectorAll('h2, h3');
      const tocItems: string[] = [];
      
      headings.forEach((heading, index) => {
        const id = heading.id || `heading-${index}`;
        if (!heading.id) heading.id = id;
        
        const level = heading.tagName === 'H2' ? '' : 'ml-3';
        const text = heading.textContent || '';
        
        tocItems.push(`
          <a href="#${id}" class="block py-1 text-zinc-600 hover:text-orange-500 transition-colors ${level}">
            ${text}
          </a>
        `);
      });
      
      tocNav.innerHTML = tocItems.join('');
    }
  });
</script>
